qprocess
net stats server/workstation (Queries Server or Workstation service from services.msc)
sfc /scannow
vssadmin list writers/providers

wevtutil query-events System /count:3 /rd:true /format:text /q:"Event[System[(EventID=6005)]]"

•	List Permissions of current directory and all subdirectories.
dir /s | icacls * /c /t > C:\temp\Perms.xls 
Export to xls not txt, else formatting may not make sense.

•	List Paths where “Access was denied” meaning ownership is not with current user and thus query failed
(Long Paths will most likely fail; Full path shown since /b has been included)
dir /b /s | icacls . /verify /c /t | findstr -i Access (use as suffix > C:\temp\Perms_Denied.xls (or txt since these are one liners) if you want to export it)

WSUS Client
wuauclt /detectnow
wuauclt /reportnow

Delprof
DelProf2.exe /i /u /ed:Administrator /c:Hostname

Reg Query HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall /S /v DisplayName

SYDI Wrapper
cscript.exe sydi-server.vbs -ex -sh -o""C:\temp\DC1.xml -t.""

quser /server <IP>
logoff <session number> /server <IP>

get-vm | Get-HardDisk | where {$_.Persistence -eq "IndependentPersistent"}

dcdiag /c /e /v /q

Reload Perf Counters : lodctr /r
List Available Counters : typeperf -qx
Disable Disk Perf : diskperf -N
Enable Disk Perf : diskperf -Y

fsutil fsinfo ntfsinfo <drive letter>
repadmin /showrepl /errorsonly
repadmin /syncall /APed


tasklist /svc : List Processes along with their Service Name (if any)
tasklist /FI "STATUS eq running" : Find all running Processes
Add /FO List to get list format in output
setspn -a http//
setspn -x -f (x for 'any', f for 'search forest', q for 'query specific')

net use		: To view all Shared Drives
net view \\HOST	: To list all shares

dsquery server -o rdn	: List all DCs in Domain
netdom query fsmo	: FSMO Role Holders

PSEXEC.EXE @serverslist.txt NET LOCALGROUP "Guests" "anonymous" /DELETE
PSEXEC.EXE @serverslist.txt NET LOCALGROUP "Users" "anonymous" /ADD

set devmgr_show_nonpresent_devices=1
devmgmt.msc

esxcli storage nmp satp rule list | grep "3PARdata"
esxcli storage nmp satp rule add -s "VMW_SATP_ALUA" -P "VMW_PSP_RR" -O "iops=1" -c "tpgs_on" -V "3PARdata" -M "VV" -e "HPE 3PAR Custom Rule"

reg load HKU\<username> C:\Users\<username>\ntuser.dat
wuauclt /detectnow
wuauclt /reportnow

esxtop -b -d 2 -n 300 > /esxtopoutput.csv (2 secs is minimum for d, if set to 1 then it auto changes to 2) > Can open in Perfmon
esxcli storage core device set --state=off -d naa.60002ac000000000000001e000015048
esxcli storage core device detached list | grep -i naa.60002ac0000000000000003b00015048
find /vmfs/volumes -name *.[i,I][s,S][o,O]

vmfsfilelockinfo -p xxxx-flat.vmdk

runas /profile /user:administrator “Driver:\folder\program”

esxcfg-nics -l
esxcli network nic up -n vmnic10
esxcli network nic get -n vmnic10

dir /b /s | icacls . /verify /T /C | findstr -i Access

wf.msc > Windows Firewall (Advanced)

(PowerShell 5.1) Win8.1AndW2K12R2-KB3191564-x64
tar –xvzf build_X_XX.tgz

Search-ADAccount -UsersOnly -AccountInactive -TimeSpan 90 | ?{$_.enabled -eq $true} | %{Get-ADUser $_.ObjectGuid} | select name, givenname, surname | export-csv unusedaccounts.csv -NoTypeInformation

https://www.postgresql.org/ftp/projects/pgFoundry/dbsamples/pagila/
https://www.enterprisedb.com/downloads/postgres-postgresql-downloads#windows
http://www.itflee.com/hacking/resources Paul Hill's Website)
https://www.offensive-security.com/kali-linux-vmware-wirtualbox-image-download/

java.com/en/download/manual.jsp
ftp://ftp.adobe.com/pub/adobe/reader/win > Get exe & msp

DelProf2.exe /i /u /ed:citadmin /c:HOSTNAME

Rescan all HBAs every week.
get-vm | where { $_ | get-cddrive | where { $_.ConnectionState.Connected -eq "true" } } | select Name

Memory Diagnostic : mdsched.exe (Needs restart, immediate or next)

PS for AD Deleted Users:
[datetime]$StartTime = "9/9/2017"
[datetime]$EndTime = "11/1/2017"
Get-ADObject -Filter {(isdeleted -eq $true) -and (name -ne "Deleted Objects")} -includeDeletedObjects -property whenChanged | Where-Object {$_.whenChanged -ge $StartTime -and $_.whenChanged -le $EndTime}

Reg Query HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall /S /v DisplayName

Get-Service * | where{$_.status -eq "Running"} | Out-Gridview
Get-Acl HKCU:\Software\Microsoft\Windows | Format-list

where /R . wmic.xlsx

(Windows Time Service In Depth) https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/windows-time-service/how-the-windows-time-service-works
(MCSA) https://quizlet.com/31470118/msca-70-412-exam-an-flash-cards/

Get-ADUser -Filter * -Properties mail | select sAMAccountName, givenName, surname, userPrincipalName, mail | ogv

cscript.exe sydi-server.vbs -ex -sh -o""C:\temp\DC1.xml -t.""

permit tcp host 192.168.25.17 eq domain host 192.168.29.30
permit udp host 192.168.25.17 eq domain host 192.168.29.30

nltest /dsgetdc: /force
https://blogs.technet.microsoft.com/musings_of_a_technical_tam/2012/02/15/group-policy-basics-part-2-understanding-which-gpos-to-apply/

subst j: . // Create Virtual Drive (non admin cmd)
subst /d j:

search-adaccount -accountinactive -usersonly -timespan "195" | export-csv -path C:\"inactive.csv"

quser /server <IP>
logoff <session number> /server <IP>

get-vm | Get-HardDisk | where {$_.Persistence -eq "IndependentPersistent"}

Get ADID Owner : Get-ADUser -filter * | Select name,@{n="owner";e={(Get-Acl "ad:\$($_.distinguishedname)").owner}} >> AD.txt
Get Object Owner : Get-ADComputer -filter * | Select name,@{n="owner";e={(Get-Acl "ad:\$($_.distinguishedname)").owner}} >> AD.txt

dsget group "DN" -members >> I:\Members.txt

FTP Related : mmc %systemroot%\system32\inetsrv\iis.msc

CACLS TASKS /E /G builtin\administrators:F
dcdiag /c /e /v /q

Reload Perf Counters : lodctr /r
List Available Counters : typeperf -qx
Disable Disk Perf : diskperf -N
Enable Disk Perf : diskperf -Y

wmic sysdriver

netstat -an | findstr LISTENING 
netstat -ano (o for Open)
Get-WmiObject win32_SystemEnclosure -ComputerName <ServerName> | select serialnumber
gwmi win32_ComputerSystem -ComputerName <ServerName> | select OEMStringArray

w32tm /resync
w32tm /tz
w32tm /monitor /domain:TWUTIL.NET (shortcut to find out total number of DCs in Domain)

robocopy \\TRFIWP01\USERS-D\TMORROW \\TDFIWP01\USERS-D\TMORROW /MIR /SEC /L /R:0 /W:0 /LOG+:log.txt

dsquery group -name "group name" | dsget group -members -expand

fsutil fsinfo ntfsinfo <drive letter>
sc GetDisplayName <Service Name> - From Services Tab in Task Manager for Services in sevices.msc
reset session <Session Name | Session ID>
qprocess

repadmin /showrepl /csv >> X.csv
repadmin /showrepl /errorsonly

ntdsutil

psexec.exe -i -s cmd.exe
pskill -t scanner.exe

dir /s *.exe
dir /q \\Path : Lists Owner

msinfo32 or msinfo32.exe

Check Permission :
cacls \\Path
icacls \\Path

DISM.exe /Online /English /Get-Features /Format:Table
DISM /online /Cleanup-Image /SpSuperseded - Clean Winsxs after SP Upgrade

psexec \\ivrdbwp01a net localgroup "Remote Desktop Users" "twutil\RKUMARVG" /add

DISM /Online /Get-Packages : List all installed updates (Elevated CMD)
dism /online /get-packageinfo /packagename:Package_for_KB958488~31bf3856ad364e35~amd64~~6.2.7600.16513

WMIC QFE List for KB#
Pre Win 2003 : QFECHECK /V

KB839803 : ServicesPipeTimeout

For deleting CBS.log kill process TrustedInstaller.

C:\TEMP // FOR /f %a in (Input.txt) DO dsquery user -name %a >> Output.txt

FOR /f %a in (Input.txt) DO net view \\%a >> Output.txt
FOR /f %a in (Input.txt) DO cacls %a >> Output.txt

Install.bat
________________________________________________________________________________________
@ECHO OFF
TITLE MSU Patches Installation
FOR %%i IN ("C:\temp\Patches\*.msu") DO START /WAIT "" WUSA.EXE "%%i" /quiet /norestart
EXIT
________________________________________________________________________________________

tasklist /svc : List Processes along with their Service Name (if any)
tasklist /FI "STATUS eq running" : Find all running Processes
Add /FO List to get list format in output
setspn -a http//
setspn -x -f (x for 'any', f for 'search forest', q for 'query specific')

net use		: To view all Shared Drives
net view \\HOST	: To list all shares

dsquery server -o rdn	: List all DCs in Domain
netdom query fsmo	: FSMO Role Holders

Elevated cmd : net stop "windows update" // Loses effect after session for us due to GP

cd C:\SysInternalSuite\
copy con serverslist.txt <<enter list of servers>> -> Ctrl+Z -> Enter
PSEXEC.EXE @serverslist.txt NET LOCALGROUP "Guests" "USER" /DELETE
PSEXEC.EXE @serverslist.txt NET LOCALGROUP "Users" "USER" /ADD

Routing Table : netstat -r

set devmgr_show_nonpresent_devices=1
devmgmt.msc

https://www.drupal.org/node/31506 : CRON Jobs

schtasks /create /tn "Copy" /sc Minute /mo 3 /tr "D:\Copy.bat
at 13:11 /EVERY:Th Forfiles.exe -p D:\X -m *.txt -c \"Cmd.exe /C del @path\"
at 18:30 /EVERY:M,T,W,Th,F "D:\DD files posting\Debug\ ConsoleApplication8.exe" /Yes

WMIC	: http://betanews.com/2011/01/14/wmic-the-best-command-line-tool-you-ve-never-used/

sfc /scannow 						- System File Checker

regsvr32 Softpub.dll					- Register Mentioned DLL Files (0x800C0005 or 0x8004005)
regsvr32 Wintrust.dll
regsvr32 Initpki.dll

(Unsure) In case it's a 32 bit dll in a 64 bit machine, we have to go ahead and paste in C:\Windows\SysWOW64\ then go there from an elevated cmd and then regsvr32. Reboot required.

In case of explorer.exe failure try,

regsvr32 -u regsys32.dll				- Unregister .dll
regsvr32 regsys32.dll

In 64 bit system,

cd \windows\syswow64
regsvr32 c:\filename.dll

adsiedit.msc

ipconfig /flushdns

driverquery /s Hostname

wmic /Node:Hostname LogicalDisk Where DriveType="3" Get DeviceID,FileSystem,FreeSpace,Size

wmic useraccount get name,sid
wmic useraccount where name='username' get sid
wmic useraccount where (name='administrator' and domain='%userdomain%') get name,sid
wmic service get /format:hform > C:\Services.html
wmic bios get serialnumber
wmic os get osarchitecture

wmic OS get Caption,CSDVersion,OSArchitecture,Version
wmic path win32_physicalmedia get SerialNumber
wmic BIOS get Manufacturer,Name,SMBIOSBIOSVersion,Version
wmic CPU get Name,NumberOfCores,NumberOfLogicalProcessors
wmic MEMPHYSICAL get MaxCapacity
wmic MEMORYCHIP get Capacity,DeviceLocator,PartNumber,Tag
wmic NIC get Description,MACAddress,NetEnabled,Speed
wmic DISKDRIVE get Caption,InterfaceType,Name,Size,Status
wmic USERACCOUNT get Caption,Name,PasswordRequired,Status
wmic path win32_physicalmedia get SerialNumber

gpresult /r

Connect-VIServer -Server <Hostname/IP> -Protocol https -User <Username>



Firewall Commands :

netsh firewall set service type = fileandprint mode = enable
netsh firewall set service type = remoteadmin mode = enable

Citrix:

qfarm HOSTNAME /load
qfarm HOSTNAME /app
qfarm /online
qfarm /offline
qfarm /app


net stop Citrix IMA
dsmaint recreatelhc


// VSS Timeout Issues

Restartnig Services	: https://support.software.dell.com/appassure/kb/129774

// Adjusting Timeout Limit

You can adjust the timeout period in the registry, by adding the DWORD registry key HKLM\SYSTEM\CurrentControlSet\services\VSS\Settings\IdleTimeout, and setting it to the number of seconds you want VSS to wait in an idle state before shutting down. Default is 180 seconds.

If you suspect that VSS shutting down is causing you problems, try setting it to 0xffffffff, which would be about 136 years. See if that helps you any.


// Clean Manager Locations

Windows Server 2008 R2 - 64-bit - C:\Windows\winsxs\amd64_microsoft-windows-cleanmgr_31bf3856ad364e35_6.1.7600.16385_none_c9392808773cd7da\cleanmgr.exe
Windows Server 2008 R2 - 64-bit - C:\Windows\winsxs\amd64_microsoft-windows-cleanmgr.resources_31bf3856ad364e35_6.1.7600.16385_en-us_b9cb6194b257cc63\cleanmgr.exe.mui

%AllUsersProfile%\Application Data\Microsoft\Dr Watson

unhide.bat :

CD\
DIR /AD /S /B

Event ID :

[Security Tab]

627 - Password Change Attempt
628 - Password Changed by Admins
642 - Password Updated
